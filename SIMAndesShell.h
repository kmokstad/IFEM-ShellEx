// $Id$
//==============================================================================
//!
//! \file SIMAndesShell.h
//!
//! \date Feb 20 2024
//!
//! \author Knut Morten Okstad / SINTEF
//!
//! \brief Solution driver for FE analysis using the ANDES shells elements.
//!
//==============================================================================

#ifndef _SIM_ANDES_SHELL_H
#define _SIM_ANDES_SHELL_H

#include "SIMElasticity.h"
#include "SIM2D.h"


/*!
  \brief Driver class for isogeometric FEM analysis of nonlinear elastic beams.
*/

class SIMAndesShell : public SIMElasticity<SIM2D>
{
public:
  //! \brief Default constructor.
  //! \param[in] n Number of consequtive solution vectors in core
  explicit SIMAndesShell(unsigned char n = 1);
  //! \brief Empty destructor.
  virtual ~SIMAndesShell() {}

protected:
  //! \brief Reads a patch from given input stream.
  //! \param[in] isp The input stream to read from
  //! \param[in] pchInd 0-based index of the patch to read
  //! \param[in] whiteSpace For message formatting
  virtual ASMbase* readPatch(std::istream& isp, int pchInd, const CharVec&,
                             const char* whiteSpace) const;

  //! \brief Returns the actual integrand.
  virtual ElasticBase* getIntegrand();

  //! \brief Initializes the body load properties for current patch.
  virtual bool initBodyLoad(size_t) { return true; }

private:
  unsigned char nsv; //!< Number of consequtive solution vectors in core
};

#endif
